---
es_service_name: 'elasticsearch'
es_service_path: '/docker/{{ es_service_name }}'
es_compose_path: '{{ es_service_path }}/docker-compose.yml'

# Mandatory variables
es_cluster_name: ~
# Set to true when bootstrapping, then disable.
es_cluster_bootstrap: false

# what host to connect to in cluster
es_master_nodes: []

# Containers -----------------------------------------------
es_docker_network_name: '{{ es_service_name }}'
# Node
es_node_cont_name: '{{ es_service_name }}-node'
es_node_cont_vol: '{{ es_service_path }}/node'
es_node_cont_tag: '7.17.28'
es_node_cont_image: 'elasticsearch:{{ es_node_cont_tag }}'
es_node_cont_uid: 1000
es_node_host_uid: '{{ 100000 + es_node_cont_uid | int }}'
# Exporter
es_exp_cont_enabled: true
es_exp_cont_name: '{{ es_service_name }}-exp'
es_exp_cont_tag: 'v1.9.0'
es_exp_cont_image: 'quay.io/prometheuscommunity/elasticsearch-exporter:{{ es_exp_cont_tag }}'
es_exp_cont_port: 9114
es_exp_timeout: '10s'
# ----------------------------------------------------------

# Listen ports and addresses
es_api_port: 9200
es_node_port: 9300
es_listen_addr: '0.0.0.0'

# Indices
es_number_of_replicas: 2
es_number_of_shards: '{{ (es_master_nodes | length) }}'
es_mapping_total_fields_limit: 1000

# Mappings for fields enforced by default template
es_default_template_mappings: {}
# Query optimization to not search throguh all fields. Can be a list.
es_default_query_default_field: '*'

# Tuning
es_node_concurrent_recoveries: 2

# JVM
ex_memory_lock: false
es_max_map_count: 262144
es_jvm_g1gc_enabled: false
es_jvm_heap_auto: true
#es_jvm_min_heap: ~
#es_jvm_max_heap: ~

# Pruning
es_pruning_path: '{{ es_service_path }}/prune'
es_pruning_venv_path: '{{ es_pruning_path }}/.venv'
es_pruning_logs_path: '{{ es_pruning_path }}/logs'
es_pruning_esclean_path: '{{ es_pruning_path }}/esclean.py'
es_pruning_script_path: '{{ es_service_path }}/prune.sh'
es_pruning_deps: ['elasticsearch', 'retry']
es_pruning_enabled: false
es_pruning_timeout: 300
es_pruning_frequency: 'weekly'
es_pruning_filters_available:
  - 'tag'
  - 'index_pattern'
  - 'program'
  - 'fleet'
  - 'severity'
  - 'logsource'
  - 'logsource_ip'
  - 'message'
  - 'query'
  - 'older_than'
es_pruning_queries: []
#- tag: '_grokparsefailure'         # match
#  index-pattern: 'logstash-2024.*' # wildcard
#  program: 'docker/some*container' # wildcard or term
#  fleet: 'env.stage'               # match
#  severity: 'debug'                # term
#  logsource: 'example.com'         # match
#  logsource_ip: '192.0.2.1'        # term
#  message: 'hello world'           # match_phrase
#  query: 'title:search'            # query_string
#  older_than: 30                   # days

# general container management
compose_recreate: 'auto'
compose_state: 'present'
compose_pull: 'always'
